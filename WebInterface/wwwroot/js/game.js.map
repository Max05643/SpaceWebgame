{"version":3,"file":"game.js","mappings":"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","sources":["webpack://sample/webpack/universalModuleDefinition","webpack://sample/webpack/runtime/chunk loaded","webpack://sample/./Scripts/audio.ts","webpack://sample/./Scripts/conversion.ts","webpack://sample/./Scripts/game.ts","webpack://sample/./Scripts/gamedesign.ts","webpack://sample/./Scripts/gamepage.ts","webpack://sample/./Scripts/graphic.ts","webpack://sample/./Scripts/inpututils.ts","webpack://sample/./Scripts/network.ts","webpack://sample/./Scripts/technical.ts","webpack://sample/./Scripts/ui.ts","webpack://sample/webpack/bootstrap","webpack://sample/webpack/runtime/define property getters","webpack://sample/webpack/runtime/global","webpack://sample/webpack/runtime/hasOwnProperty shorthand","webpack://sample/webpack/runtime/make namespace object","webpack://sample/webpack/runtime/node module decorator","webpack://sample/webpack/runtime/jsonp chunk loading","webpack://sample/webpack/startup"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"sample\"] = factory();\n\telse\n\t\troot[\"sample\"] = factory();\n})(self, () => {\nreturn ","var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","import * as Sound from '@pixi/sound';\r\nimport * as GameDesign from './gamedesign';\r\n\r\nexport namespace Audio {\r\n\r\n\r\n\r\n    export class MusicController {\r\n\r\n        private musicInstance: Sound.Sound;\r\n        private targetVol: number = 0.5;\r\n        constructor() {\r\n            if (localStorage.getItem(\"music_vol\") != null) {\r\n                const currentVol = parseFloat(localStorage.getItem(\"music_vol\")!);\r\n                this.targetVol = !isNaN(currentVol) ? currentVol : 0.5;\r\n            }\r\n\r\n\r\n            this.musicInstance = Sound.Sound.from('/assets/music/soundtrack.wav');\r\n            this.musicInstance.loop = true;\r\n            this.musicInstance.volume = this.targetVol;\r\n            this.musicInstance.play();\r\n        }\r\n    }\r\n    export class AudioController {\r\n\r\n        private lastEffectPlayedId: number = -1;\r\n        private targetVol: number = 0.5;\r\n\r\n        constructor() {\r\n            Sound.sound.add(\"ex0\", \"/assets/sound/explosion0.wav\");\r\n            Sound.sound.add(\"ex1\", \"/assets/sound/explosion1.wav\");\r\n            Sound.sound.add(\"lr\", \"/assets/sound/laser.wav\");\r\n            Sound.sound.add(\"pk\", \"/assets/sound/pick.wav\");\r\n            Sound.sound.add(\"mvt\", \"/assets/sound/movement.wav\");\r\n\r\n            if (localStorage.getItem(\"sound_vol\") != null) {\r\n                const currentVol = parseFloat(localStorage.getItem(\"sound_vol\")!);\r\n                this.targetVol = !isNaN(currentVol) ? currentVol : 0.5;\r\n            }\r\n        }\r\n\r\n\r\n\r\n        private PlayOneShot(effect: GameDesign.SoundEffect, currentPlayerPosition: GameDesign.ClientVector2): void {\r\n\r\n            if (effect.position == null) {\r\n                const options: Sound.PlayOptions = {\r\n                    volume: this.targetVol,\r\n                    loop: false,\r\n                };\r\n                Sound.sound.play(effect.audioClipName, options);\r\n            }\r\n            else {\r\n\r\n\r\n                const distanceSuqared = GameDesign.DistanceSquared(currentPlayerPosition, effect.position);\r\n                const k = 1 - distanceSuqared / (effect.radius! * effect.radius!);\r\n\r\n\r\n\r\n                if (k > 0) {\r\n\r\n                    const filter = new Sound.filters.StereoFilter();\r\n                    if (distanceSuqared > 1)\r\n                        filter.pan = GameDesign.Normalized(GameDesign.Difference(effect.position, currentPlayerPosition)).x;\r\n                    else\r\n                        filter.pan = 0;\r\n\r\n                    const options: Sound.PlayOptions = {\r\n                        volume: k * this.targetVol,\r\n                        loop: false,\r\n                        filters: [filter]\r\n                    };\r\n                    Sound.sound.play(effect.audioClipName, options);\r\n                }\r\n            }\r\n        }\r\n\r\n        ProcessQueue(queue: GameDesign.SoundEffect[], currentPlayerPosition: GameDesign.ClientVector2): void {\r\n\r\n            for (const effect in queue) {\r\n                const currentEffect = queue[effect];\r\n\r\n                if (currentEffect.id > this.lastEffectPlayedId) {\r\n                    this.lastEffectPlayedId = currentEffect.id;\r\n                    this.PlayOneShot(currentEffect, currentPlayerPosition);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n}","import axios from 'axios';\r\n\r\n/** Used to map minimized objects to their full versions */\r\nexport class Mapper {\r\n    private clientPersonalInfoFromServerMapping: { [key: string]: string } = {};\r\n    private clientInputToServerMapping: { [key: string]: string } = {};\r\n    isReady: boolean = false;\r\n\r\n\r\n    private async Initialize(): Promise<void> {\r\n\r\n        const result1 = await axios.get(\"/assets/clientInputMap.json\");\r\n        this.clientInputToServerMapping = result1.data;\r\n\r\n        const result2 = await axios.get(\"/assets/clientPersonalInfoMap.json\");\r\n        this.clientPersonalInfoFromServerMapping = result2.data;\r\n\r\n        this.isReady = true;\r\n    }\r\n\r\n    constructor() {\r\n        this.Initialize();\r\n    }\r\n\r\n    mapClientInputToServer(obj: any) {\r\n        return this.mapObj(obj, this.clientInputToServerMapping);\r\n    }\r\n\r\n    mapClientPersonalInfoFromServer(obj: any) {\r\n        return this.mapObj(obj, this.clientPersonalInfoFromServerMapping);\r\n    }\r\n\r\n    private mapObj(obj: any, mapping: { [key: string]: string }) {\r\n        const result: any = {};\r\n\r\n        for (const key in obj) {\r\n            const newKey = (mapping[key] == undefined) ? key : mapping[key];\r\n\r\n            if (obj[key] == null) {\r\n                result[newKey] = null;\r\n            }\r\n            else {\r\n                result[newKey] = typeof obj[key] === 'object' ? this.mapObj(obj[key], mapping) : obj[key];\r\n            }\r\n\r\n        }\r\n        return result;\r\n    }\r\n}","import { Network } from './network';\r\nimport { Technical } from './technical';\r\nimport { InputUtils } from './inpututils';\r\nimport { UI } from './ui';\r\nimport { Graphic } from './graphic';\r\nimport { Audio } from './audio';\r\nimport * as GameDesign from './gamedesign';\r\n\r\nexport namespace Game {\r\n\r\n\r\n    /** Represents an instance of the game */\r\n    export class GameInstance {\r\n\r\n        playerId: string;\r\n\r\n        serverConnection: Network.ServerConnection;\r\n        technicalInfo: Technical.TechnicalInfo = new Technical.TechnicalInfo();\r\n        keyboardInputHandler: InputUtils.KeyboardInputHandler;\r\n        gameUI: UI.GameUI;\r\n        scene: Graphic.GameScene;\r\n        audioController: Audio.AudioController;\r\n        musicController: Audio.MusicController;\r\n        chatController: UI.ChatController;\r\n\r\n\r\n        constructor(playerId: string, document: Document) {\r\n            this.playerId = playerId;\r\n            this.gameUI = new UI.GameUI(document.getElementById(\"revivebutton\") as HTMLButtonElement,\r\n                document.getElementById(\"revivemessage\") as HTMLDivElement,\r\n                document.getElementById(\"debugmessage\") as HTMLParagraphElement,\r\n                document.getElementById(\"players-table\") as HTMLTableElement,\r\n                document.getElementById(\"safezonemessage\") as HTMLDivElement,\r\n                document.getElementById(\"investments-table\") as HTMLTableElement,\r\n                document.getElementById(\"damage-effect\") as HTMLTableElement\r\n            );\r\n\r\n            this.serverConnection = new Network.ServerConnection(\"/gamehub\");\r\n            this.keyboardInputHandler = new InputUtils.KeyboardInputHandler(document);\r\n            this.scene = new Graphic.GameScene(document, () => this.MainLoop(), 30,\r\n                document.getElementById(\"progress-bar-sample\") as HTMLDivElement);\r\n            this.audioController = new Audio.AudioController();\r\n            this.musicController = new Audio.MusicController();\r\n\r\n            try {\r\n                this.serverConnection.InitializeServerConnection((message: GameDesign.ClientGameState) => this.ReceiveGameState(message));\r\n            }\r\n            catch (error) {\r\n                console.error(\"Error initializing:\", error);\r\n            }\r\n\r\n            this.chatController = new UI.ChatController(document.getElementById(\"sendchatbutton\") as HTMLButtonElement,\r\n                document.getElementById(\"chattextcontainer\") as HTMLDivElement,\r\n                document.getElementById(\"inputchatmessage\") as HTMLInputElement,\r\n                async (message: string) => { return await this.serverConnection.SendChatMessage(message); }\r\n            );\r\n\r\n            //Start to update chat every second\r\n            setInterval(() => { this.serverConnection.GetChatMessages(this.chatController.GetLastReceivedMaxId()).then((messages) => { this.chatController.StoreNewMessages(messages); }); }, 1000);\r\n        }\r\n\r\n\r\n        lastReceivedGameState: GameDesign.ClientGameState | null = null;\r\n        lastProcessedGameState: GameDesign.ClientGameState | null = null;\r\n\r\n\r\n\r\n        /** Stores an update as a newest client personal info */\r\n        ReceiveGameState(update: GameDesign.ClientGameState) {\r\n\r\n            const currentUpdateTime: number = new Date().getTime();\r\n            this.technicalInfo.lastFrameTimeMs = currentUpdateTime - this.technicalInfo.lastUpdateTime;\r\n            this.technicalInfo.lastUpdateTime = currentUpdateTime;\r\n\r\n\r\n            if (this.lastReceivedGameState != null)\r\n                this.technicalInfo.extraGoodFrames++;\r\n\r\n            this.lastReceivedGameState = update;\r\n        }\r\n\r\n\r\n        /** A main game loop that gets called every frames. Repaint all the sprites based on last info from the server or extrapolates the last known state of the game */\r\n        MainLoop(): void {\r\n\r\n\r\n\r\n            let isGood: boolean = false;\r\n            if (this.lastReceivedGameState == null && this.lastProcessedGameState == null)\r\n                return;\r\n            else if (this.lastReceivedGameState == null) {\r\n                this.technicalInfo.droppedFrames++;\r\n\r\n                if (this.lastProcessedGameState != null)\r\n                    GameDesign.ApplyExtrapolation(this.lastProcessedGameState, this.scene.app.ticker.elapsedMS / 1000);\r\n            }\r\n            else {\r\n                this.technicalInfo.goodFrames++;\r\n                isGood = true;\r\n                this.lastProcessedGameState = this.lastReceivedGameState;\r\n                this.lastReceivedGameState = null;\r\n            }\r\n\r\n\r\n            if (this.lastProcessedGameState == null) {\r\n                this.scene.app.view.hidden = true;\r\n                this.scene.RemoveAllGraphics();\r\n                return;\r\n            }\r\n\r\n            this.gameUI.RepaintReviveInterface(this.lastProcessedGameState);\r\n            this.gameUI.RepaintDamageEffects(this.lastProcessedGameState);\r\n            this.gameUI.RepaintSafeZoneMessage(this.lastProcessedGameState);\r\n            this.gameUI.RepaintInvestmentsTable(this.lastProcessedGameState);\r\n\r\n\r\n            if (isGood) {\r\n                var input = this.keyboardInputHandler.GetUsersInput();\r\n                this.gameUI.AddInputFromUI(input);\r\n                this.serverConnection.SendMyInput(input);\r\n            }\r\n\r\n\r\n            if (!GameDesign.IsPlayerInGame(this.lastProcessedGameState)) {\r\n                this.scene.app.view.hidden = true;\r\n                this.scene.RemoveAllGraphics();\r\n                return;\r\n            }\r\n            else {\r\n                this.scene.app.view.hidden = false;\r\n            }\r\n\r\n\r\n            this.scene.DisplayGameObjects(this.lastProcessedGameState);\r\n\r\n\r\n\r\n\r\n            this.audioController.ProcessQueue(this.lastProcessedGameState.soundEffectsQueue, this.lastProcessedGameState.objects[this.lastProcessedGameState.gameObjectsId].position);\r\n\r\n            this.gameUI.DebugMyPositionAndVelocity(this.lastProcessedGameState, this.technicalInfo);\r\n        }\r\n\r\n    }\r\n\r\n}","export class GameMessageContainer {\r\n    public id: number = -1;\r\n    public message: GameMessage | null = null;\r\n}\r\nexport class GameMessage {\r\n    public senderNick: string = \"\";\r\n    public message: string = \"\";\r\n}\r\n\r\nexport const playerViewportMaxSize: ClientVector2 =\r\n{\r\n    x: 1500,\r\n    y: 1500,\r\n    Length(): number {\r\n        return Math.sqrt(this.LengthSquared());\r\n    },\r\n    LengthSquared(): number {\r\n        return this.x * this.x + this.y * this.y;\r\n    }\r\n};\r\n\r\nexport const playerAttributes: { [key: number]: string } = {\r\n    0: \"MaxHealth\",\r\n    1: \"PhysicalDamage\",\r\n    2: \"ProjectileDamage\",\r\n    3: \"Power\",\r\n    4: \"Acceleration\",\r\n    5: \"AngularSpeed\",\r\n    6: \"Reload\",\r\n};\r\n\r\nexport const possiblePlayersStatus = {\r\n    0: \"Alive\",\r\n    1: \"Dead\",\r\n    2: \"Not entered the game\"\r\n}\r\n\r\n/** Represents an audio effect. The effect can just be played or played in particular part of global world*/\r\nexport class SoundEffect {\r\n    audioClipName: string = \"\";\r\n    position: ClientVector2 | null = null;\r\n    radius: number | null = null;\r\n    id: number = 0;\r\n}\r\n\r\nexport const graphicTypeNone = 0;\r\nexport const graphicTypeStatic = 1;\r\nexport const graphicTypeAnimated = 2;\r\n\r\n\r\nexport function GetEstimatedSize(graphicInfo: GraphicInfo): ClientVector2 {\r\n    const result = new ClientVector2();\r\n\r\n    if (graphicInfo.targetSize == null) {\r\n        result.x = 100;\r\n        result.y = 100;\r\n    }\r\n    else {\r\n        result.x = graphicInfo.targetSize.x;\r\n        result.y = graphicInfo.targetSize.y;\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nexport class GraphicLibraryEntry {\r\n    public type: number = graphicTypeNone;\r\n    public spriteInfo: SpriteInfo | null = null;\r\n    public animatedSpriteInfo: AnimatedSpriteInfo | null = null;\r\n}\r\n\r\nexport class AnimationInfo {\r\n    public secondsCompleted: number = 0;\r\n}\r\n\r\nexport class GraphicInfo {\r\n    public objectAnimationInfo: AnimationInfo | null = null;\r\n    public graphicLibraryEntryId: number = 0;\r\n    public targetSize: ClientVector2 = new ClientVector2();\r\n}\r\n\r\nexport class SpriteInfo {\r\n    public sprite: string | null = null;\r\n}\r\nexport class AnimatedSpriteInfo {\r\n    public animationName: string | null = null;\r\n    public isLoop: boolean = false;\r\n    public targetTimeInSeconds: number = 1;\r\n    public completedTimeInSeconds: number = 0;\r\n}\r\n\r\nexport function NeedToChangeGraphic(currentInfo: GraphicInfo, newInfo: GraphicInfo): boolean {\r\n    return currentInfo.graphicLibraryEntryId != newInfo.graphicLibraryEntryId;\r\n}\r\n\r\n\r\nexport class ClientGameObject {\r\n    public position: ClientVector2 = new ClientVector2();\r\n    public velocity: ClientVector2 = new ClientVector2();\r\n    public graphicInfo: GraphicInfo = new GraphicInfo();\r\n    public angle: number = 0;\r\n\r\n    public children: { [key: string]: ClientGameObject } = {};\r\n\r\n    public features: { [key: string]: string } = {};\r\n\r\n}\r\n\r\nexport class ClientGameState {\r\n    public playersCount: number = 0;\r\n    public objects: { [key: string]: ClientGameObject } = {};\r\n    public soundEffectsQueue: SoundEffect[] = [];\r\n    isSafeZone: boolean = false;\r\n    points: number = 0;\r\n    alreadyInvested: { [investmentType: number]: number; } | null = null;\r\n    health: number = 0;\r\n    maxHealth: number = 0;\r\n    gameObjectsId: string = \"\";\r\n    state: PlayerState = PlayerState.NotEntered;\r\n}\r\n\r\n/** Checks if specified player is currently in the game and is alive */\r\nexport function IsPlayerInGame(gameState: ClientGameState | null): boolean {\r\n    return gameState != null && gameState.state == PlayerState.Alive;\r\n}\r\n\r\n\r\n\r\nexport function Difference(a: ClientVector2, b: ClientVector2): ClientVector2 {\r\n    const result = new ClientVector2();\r\n\r\n    result.x = a.x - b.x;\r\n    result.y = a.y - b.y;\r\n\r\n    return result;\r\n}\r\nexport function Distance(a: ClientVector2, b: ClientVector2): number {\r\n    return Math.sqrt(DistanceSquared(a, b));\r\n}\r\nexport function DistanceSquared(a: ClientVector2, b: ClientVector2): number {\r\n    const dx = a.x - b.x;\r\n    const dy = a.y - b.y;\r\n    return dx * dx + dy * dy;\r\n}\r\n\r\nexport function Normalized(a: ClientVector2): ClientVector2 {\r\n    const result = new ClientVector2();\r\n    const length = Math.sqrt(a.x * a.x + a.y * a.y);\r\n\r\n    result.x = a.x / length;\r\n    result.y = a.y / length;\r\n\r\n    return result;\r\n}\r\n\r\nexport class ClientVector2 {\r\n    public x: number = 0;\r\n    public y: number = 0;\r\n\r\n    Length(): number {\r\n        return Math.sqrt(this.LengthSquared());\r\n    }\r\n\r\n    LengthSquared(): number {\r\n        return this.x * this.x + this.y * this.y;\r\n    }\r\n}\r\n\r\nexport enum PlayerState {\r\n    Alive = 0,\r\n    Dead = 1,\r\n    NotEntered = 2\r\n}\r\n\r\nexport class ClientInput {\r\n    public angle: number = 0;\r\n    public movementPower: number = 0;\r\n    public isFire: boolean = false;\r\n    public investmentRequest: number | null = null;\r\n    public repairRequest: boolean = false;\r\n    public reviveRequest: boolean = false;\r\n}\r\n\r\n\r\n/** Applies extrapolation to the gameState, i.e. moves objects to their estimated positions */\r\nexport function ApplyExtrapolation(gameState: ClientGameState, delta: number): void {\r\n    for (const objectName in gameState.objects) {\r\n        const objectInfo = gameState.objects[objectName];\r\n        objectInfo.position.x = objectInfo.position.x + objectInfo.velocity.x * delta;\r\n        objectInfo.position.y = objectInfo.position.y + objectInfo.velocity.y * delta;\r\n    }\r\n\r\n    gameState.soundEffectsQueue = [];\r\n}","import * as Game from './game';\r\n\r\nnamespace GamePage {\r\n\r\n    declare let playerId: string;\r\n\r\n    const GameInstance: Game.Game.GameInstance = new Game.Game.GameInstance(playerId, document);\r\n}","import * as PIXI from 'pixi.js';\r\nimport * as GameDesign from './gamedesign';\r\nimport axios from 'axios';\r\n\r\nexport namespace Graphic {\r\n\r\n    const universalTextStyle = new PIXI.TextStyle({\r\n        fontFamily: 'Arial',\r\n        fontSize: 12,\r\n        fill: 0xFFFFFF,\r\n        align: 'center'\r\n    });\r\n\r\n    export class GraphicLibrary {\r\n\r\n        entries: { [key: number]: GameDesign.GraphicLibraryEntry } = {};\r\n        isReady: boolean = false;\r\n\r\n        async Init(): Promise<void> {\r\n            const result = await axios.get(\"/Game/GetGraphicLibrary\");\r\n            this.entries = result.data;\r\n            this.isReady = true;\r\n        }\r\n\r\n        constructor() {\r\n            this.Init();\r\n        }\r\n\r\n    }\r\n\r\n    export class BackGroundController {\r\n\r\n        backgroundObj: PIXI.TilingSprite;\r\n\r\n        constructor(background: string, app: PIXI.Application) {\r\n            const backgroundTexture = PIXI.Texture.from('/assets/backgrounds/' + background);\r\n            this.backgroundObj = new PIXI.TilingSprite(backgroundTexture, app.screen.width, app.screen.height);\r\n\r\n            app.stage.addChild(this.backgroundObj);\r\n        }\r\n\r\n        HandleWindowResize(): void {\r\n            this.backgroundObj.width = window.innerWidth;\r\n            this.backgroundObj.height = window.innerHeight;\r\n        }\r\n\r\n        Destroy(): void {\r\n            this.backgroundObj.parent.removeChild(this.backgroundObj);\r\n        }\r\n    }\r\n\r\n    /** Represents an object in GameScene that have a sprite assigned to it*/\r\n    export class SceneObject {\r\n\r\n        pixiObj: PIXI.Container | null = null;\r\n\r\n        parent: PIXI.Container;\r\n\r\n        app: PIXI.Application;\r\n\r\n        public graphicInfo: GameDesign.GraphicInfo;\r\n\r\n        public textForObject: PIXI.Text | null = null;\r\n\r\n        public healthBar: HTMLDivElement | null = null;\r\n\r\n        public objName: string;\r\n\r\n        public children: { [key: string]: SceneObject } = {};\r\n\r\n        Destroy(): void {\r\n            for (const child in this.children) {\r\n                this.children[child].Destroy();\r\n                delete this.children[child];\r\n            }\r\n\r\n            if (this.pixiObj != null) {\r\n                this.pixiObj.parent.removeChild(this.pixiObj);\r\n                this.pixiObj = null;\r\n            }\r\n            if (this.textForObject != null) {\r\n                this.parent.removeChild(this.textForObject);\r\n                this.textForObject = null;\r\n            }\r\n            if (this.healthBar != null) {\r\n                this.healthBar.parentNode!.removeChild(this.healthBar);\r\n                this.healthBar = null;\r\n            }\r\n        }\r\n\r\n        private ApplyTransformations(targetSize: GameDesign.ClientVector2 | null, position: GameDesign.ClientVector2, angle: number): void {\r\n\r\n            this.pixiObj!.rotation = angle;\r\n            this.pixiObj!.position.set(position.x, -position.y);\r\n\r\n            if (targetSize == null || targetSize.x == 0 && targetSize.y == 0) {\r\n                return;\r\n            }\r\n            this.pixiObj!.width = targetSize.x\r\n            this.pixiObj!.height = targetSize.y;\r\n\r\n        }\r\n\r\n        private SetHealthBar(value: number | null, progressBarSample: HTMLDivElement, gameScene: GameScene, graphicLibrary: GraphicLibrary): void {\r\n            const graphicLibEntry = graphicLibrary.entries[this.graphicInfo.graphicLibraryEntryId];\r\n\r\n            if (value == null || graphicLibEntry.type == GameDesign.graphicTypeNone) {\r\n                if (this.healthBar != null)\r\n                    progressBarSample.parentNode!.removeChild(this.healthBar);\r\n                this.healthBar = null;\r\n            }\r\n            else {\r\n                if (this.healthBar == null) {\r\n                    const originalDiv = progressBarSample;\r\n                    const clonedDiv = originalDiv.cloneNode(true) as HTMLDivElement;\r\n                    clonedDiv.id = `healthbar${this.objName}`;\r\n                    progressBarSample.parentNode!.appendChild(clonedDiv);\r\n                    this.healthBar = clonedDiv;\r\n                }\r\n\r\n                const positionOfObject = new GameDesign.ClientVector2();\r\n                positionOfObject.x = (this.pixiObj!.position.x + gameScene.mainContainer.position.x) * gameScene.currentStageScale;\r\n                positionOfObject.y = (this.pixiObj!.position.y + gameScene.mainContainer.position.y + this.pixiObj!.height * 0.5) * gameScene.currentStageScale;\r\n\r\n                this.healthBar!.hidden = false;\r\n                this.healthBar!.style.display = 'block';\r\n                this.healthBar!.style.visibility = (value > 0) ? 'visible' : \"hidden\";\r\n                this.healthBar!.style.position = 'absolute';\r\n                this.healthBar!.style.left = `${positionOfObject.x - 50}px`;\r\n                this.healthBar!.style.top = `${positionOfObject.y + 30}px`;\r\n\r\n                (this.healthBar!.querySelector('.progress-bar') as HTMLDivElement).style.width = `${value}%`;\r\n                (this.healthBar!.querySelector('.progress-bar') as HTMLDivElement).setAttribute(\"aria-valuenow\", value.toString());\r\n\r\n\r\n            }\r\n        }\r\n\r\n        private SetText(text: string | null, graphicLibrary: GraphicLibrary): void {\r\n            const graphicLibEntry = graphicLibrary.entries[this.graphicInfo.graphicLibraryEntryId];\r\n\r\n            if (text == null || graphicLibEntry.type == GameDesign.graphicTypeNone) {\r\n                if (this.textForObject != null) {\r\n                    this.parent.removeChild(this.textForObject);\r\n                    this.textForObject = null;\r\n                }\r\n            }\r\n            else {\r\n\r\n                if (this.textForObject == null) {\r\n                    this.textForObject = new PIXI.Text('', universalTextStyle);\r\n                    this.parent.addChild(this.textForObject);\r\n                }\r\n\r\n                this.textForObject.text = text;\r\n                this.textForObject.anchor.set(0.5);\r\n                this.textForObject.x = this.pixiObj!.x;\r\n                this.textForObject.y = this.pixiObj!.y - this.pixiObj!.height * 0.5 - 30;\r\n            }\r\n        }\r\n\r\n        Repaint(gameObject: GameDesign.ClientGameObject, gameScene: GameScene, graphicLibrary: GraphicLibrary): void {\r\n\r\n            this.EnsureCorrectPixiObj(gameObject.graphicInfo, graphicLibrary);\r\n\r\n            this.graphicInfo = gameObject.graphicInfo;\r\n\r\n            this.ApplyTransformations(gameScene.ConvertVectorFromGlobalSpaceToViewSpace(gameObject.graphicInfo.targetSize), gameScene.ConvertVectorFromGlobalSpaceToViewSpace(gameObject.position), -gameObject.angle);\r\n\r\n\r\n\r\n            this.SetHealthBar(gameObject.features[\"health\"] == undefined ? null : parseInt(gameObject.features[\"health\"]), gameScene.progressBarSample, gameScene, graphicLibrary);\r\n            this.SetText(gameObject.features[\"text\"] == undefined ? null : gameObject.features[\"text\"], graphicLibrary);\r\n\r\n\r\n            this.RepaintChildren(gameObject, gameScene, graphicLibrary);\r\n            this.RemoveUnusedChildren(gameObject, gameScene);\r\n        }\r\n\r\n        constructor(objName: string, gameObject: GameDesign.ClientGameObject, parent: PIXI.Container, app: PIXI.Application, graphicLibrary: GraphicLibrary) {\r\n            this.objName = objName;\r\n            this.parent = parent;\r\n            this.graphicInfo = gameObject.graphicInfo;\r\n            this.app = app;\r\n            this.EnsureCorrectPixiObj(this.graphicInfo, graphicLibrary);\r\n        }\r\n\r\n\r\n        private RepaintChildren(gameObject: GameDesign.ClientGameObject, gameScene: GameScene, graphicLibrary: GraphicLibrary): void {\r\n            for (const child in gameObject.children) {\r\n                if (!(child in this.children)) {\r\n                    const newChild = new SceneObject(child, gameObject.children[child], this.pixiObj!, this.app, graphicLibrary);\r\n                    this.children[child] = newChild;\r\n                }\r\n                this.children[child].Repaint(gameObject.children[child], gameScene, graphicLibrary);\r\n            }\r\n        }\r\n        private RemoveUnusedChildren(gameObject: GameDesign.ClientGameObject, gameScene: GameScene): void {\r\n            for (const child in this.children) {\r\n                if (!(child in gameObject.children)) {\r\n                    this.children[child].Destroy();\r\n                    delete this.children[child];\r\n                }\r\n            }\r\n        }\r\n\r\n\r\n\r\n        private EnsureCorrectPixiObj(newGraphicInfo: GameDesign.GraphicInfo, graphicLibrary: GraphicLibrary): void {\r\n            const graphicLibEntry = graphicLibrary.entries[newGraphicInfo.graphicLibraryEntryId];\r\n\r\n            if (GameDesign.NeedToChangeGraphic(this.graphicInfo, newGraphicInfo)) {\r\n                this.Destroy();\r\n            }\r\n\r\n            if (this.pixiObj == null) {\r\n                if (graphicLibEntry.type == GameDesign.graphicTypeNone) {\r\n                    this.CreateFromContainer(newGraphicInfo);\r\n                }\r\n                else if (graphicLibEntry.type == GameDesign.graphicTypeStatic) {\r\n                    this.CreateFromStaticSprite(newGraphicInfo, graphicLibrary);\r\n                }\r\n                else if (graphicLibEntry.type == GameDesign.graphicTypeAnimated) {\r\n                    this.CreateFromAnimatedSprite(newGraphicInfo, graphicLibrary);\r\n                }\r\n            }\r\n        }\r\n\r\n        private CreateFromContainer(graphicInfo: GameDesign.GraphicInfo): void {\r\n            const container = new PIXI.Container();\r\n            container.pivot.set(0.5);\r\n            this.pixiObj = container;\r\n            this.parent.addChild(container);\r\n        }\r\n        private CreateFromStaticSprite(graphicInfo: GameDesign.GraphicInfo, graphicLibrary: GraphicLibrary): void {\r\n            const graphicLibEntry = graphicLibrary.entries[graphicInfo.graphicLibraryEntryId];\r\n\r\n            const newSprite = PIXI.Sprite.from(graphicLibEntry.spriteInfo!.sprite!);\r\n            this.pixiObj = newSprite;\r\n            this.parent.addChild(newSprite);\r\n\r\n        }\r\n        private CreateFromAnimatedSprite(graphicInfo: GameDesign.GraphicInfo, graphicLibrary: GraphicLibrary): void {\r\n            const graphicLibEntry = graphicLibrary.entries[graphicInfo.graphicLibraryEntryId];\r\n\r\n            const newSprite = PIXI.AnimatedSprite.fromFrames(PIXI.Assets.cache.get(\"/assets/sprites/sheet.json\").data.animations[graphicLibEntry.animatedSpriteInfo!.animationName!]);\r\n\r\n            this.pixiObj = newSprite;\r\n            newSprite.animationSpeed = (newSprite.totalFrames / this.app.ticker.maxFPS) / graphicLibEntry.animatedSpriteInfo!.targetTimeInSeconds;\r\n            newSprite.loop = graphicLibEntry.animatedSpriteInfo!.isLoop;\r\n\r\n\r\n            if (graphicLibEntry.animatedSpriteInfo!.isLoop) {\r\n                newSprite.play();\r\n            }\r\n            else {\r\n                if (graphicInfo.objectAnimationInfo == null) {\r\n                    newSprite.gotoAndPlay(0);\r\n                }\r\n                else {\r\n                    const currentFrame = Math.floor(newSprite.totalFrames * (graphicInfo.objectAnimationInfo.secondsCompleted / graphicLibEntry.animatedSpriteInfo!.targetTimeInSeconds));\r\n                    newSprite.gotoAndPlay(currentFrame);\r\n                }\r\n            }\r\n\r\n\r\n            this.parent.addChild(newSprite);\r\n\r\n        }\r\n\r\n\r\n\r\n\r\n\r\n    }\r\n\r\n    /** Represents a high-level abstraction over pixi js */\r\n    export class GameScene {\r\n\r\n        graphicLibrary: GraphicLibrary;\r\n\r\n        presentObjects: { [key: string]: SceneObject } = {};\r\n\r\n        backgroundController: BackGroundController;\r\n\r\n        currentStageScale: number = 1;\r\n\r\n        /** Stores all the game objects and keeps the player centered */\r\n        mainContainer: PIXI.Container;\r\n\r\n        private CheckIfObjectInViewport(stageCoordinates: GameDesign.ClientVector2, spriteStageSize: GameDesign.ClientVector2): boolean {\r\n            stageCoordinates.x *= this.currentStageScale;\r\n            stageCoordinates.y *= this.currentStageScale;\r\n\r\n            spriteStageSize.x *= this.currentStageScale;\r\n            spriteStageSize.y *= this.currentStageScale;\r\n\r\n            const topRight: GameDesign.ClientVector2 = new GameDesign.ClientVector2();\r\n            topRight.x = stageCoordinates.x + spriteStageSize.x * 0.5;\r\n            topRight.y = stageCoordinates.y + spriteStageSize.y * 0.5;\r\n\r\n            const bottomLeft: GameDesign.ClientVector2 = new GameDesign.ClientVector2();\r\n            bottomLeft.x = stageCoordinates.x - spriteStageSize.x * 0.5;\r\n            bottomLeft.y = stageCoordinates.y - spriteStageSize.y * 0.5;\r\n\r\n            if (topRight.x < 0 && topRight.y < 0) {\r\n                return false;\r\n            }\r\n            else if (bottomLeft.x > GameDesign.playerViewportMaxSize.x && bottomLeft.y > GameDesign.playerViewportMaxSize.y) {\r\n                return false;\r\n            }\r\n            else {\r\n                return true;\r\n            }\r\n        }\r\n\r\n        /** Converts point from global space to pixi's pixel space */\r\n        ConvertPointFromGlobalSpaceToViewSpace(input: GameDesign.ClientVector2, startOfCoordinates: GameDesign.ClientVector2): GameDesign.ClientVector2 {\r\n            const result = new GameDesign.ClientVector2();\r\n            result.x = (input.x - startOfCoordinates.x) * 10 + this.app.screen.width * 0.5 / this.currentStageScale;\r\n            result.y = -(input.y - startOfCoordinates.y) * 10 + this.app.screen.height * 0.5 / this.currentStageScale;\r\n\r\n            return result;\r\n        }\r\n\r\n        /** Converts vector from global space to pixi's pixel space */\r\n        ConvertVectorFromGlobalSpaceToViewSpace(input: GameDesign.ClientVector2): GameDesign.ClientVector2 {\r\n            const result = new GameDesign.ClientVector2();\r\n            result.x = input.x * 10;\r\n            result.y = input.y * 10;\r\n\r\n            return result;\r\n        }\r\n\r\n\r\n        app: PIXI.Application<HTMLCanvasElement>;\r\n\r\n        /** Are all assets loaded? */\r\n        isReady: boolean = false;\r\n\r\n\r\n\r\n        async PrepareSpriteSheet(): Promise<void> {\r\n\r\n            await PIXI.Assets.load([\"/assets/sprites/sheet.json\"]);\r\n            this.isReady = true;\r\n        }\r\n\r\n        /** Sample object for health indicators */\r\n        progressBarSample: HTMLDivElement;\r\n\r\n\r\n        HandleWindowResize(): void {\r\n            this.app.renderer.resize(window.innerWidth, window.innerHeight);\r\n            this.currentStageScale = Math.max(1, window.innerWidth / GameDesign.playerViewportMaxSize.x, window.innerHeight / GameDesign.playerViewportMaxSize.y);\r\n            this.app.stage.scale.set(this.currentStageScale);\r\n            this.backgroundController.HandleWindowResize();\r\n        }\r\n\r\n        constructor(document: Document, mainLoop: () => void, targetFrameRate: number = 30, progressBarSample: HTMLDivElement) {\r\n\r\n            this.progressBarSample = progressBarSample;\r\n\r\n            this.PrepareSpriteSheet();\r\n            this.graphicLibrary = new GraphicLibrary();\r\n\r\n            this.app = new PIXI.Application<HTMLCanvasElement>({\r\n                width: window.innerWidth,\r\n                height: window.innerHeight,\r\n                backgroundColor: \"#000000\",\r\n                autoDensity: true,\r\n                resolution: window.devicePixelRatio\r\n            });\r\n\r\n\r\n            this.backgroundController = new BackGroundController(\"back0.png\", this.app);\r\n\r\n            this.app.ticker.maxFPS = targetFrameRate;\r\n            document.body.appendChild(this.app.view);\r\n            this.app.ticker.add(mainLoop);\r\n            this.app.ticker.start();\r\n            this.app.view.hidden = true;\r\n\r\n            this.HandleWindowResize();\r\n            window.addEventListener('resize', () => { this.HandleWindowResize(); });\r\n\r\n            this.mainContainer = new PIXI.Container();\r\n            this.mainContainer.width = 0;\r\n            this.mainContainer.height = 0;\r\n            this.mainContainer.pivot.set(0.5);\r\n            this.app.stage.addChild(this.mainContainer);\r\n        }\r\n\r\n\r\n        private DisplayGameObject(objectName: string, objectInfo: GameDesign.ClientGameObject, startOfCoordinates: GameDesign.ClientVector2): void {\r\n\r\n            const positionInViewSpace = this.ConvertPointFromGlobalSpaceToViewSpace(objectInfo.position, startOfCoordinates);\r\n            if (!this.CheckIfObjectInViewport(positionInViewSpace, GameDesign.GetEstimatedSize(objectInfo.graphicInfo))) {\r\n                this.EnsureGraphicObjectRemoved(objectName);\r\n            }\r\n            else {\r\n                let currentHandle: SceneObject | null = null;\r\n\r\n                if (objectName in this.presentObjects) {\r\n                    currentHandle = this.presentObjects[objectName];\r\n                }\r\n                else {\r\n                    currentHandle = new SceneObject(objectName, objectInfo, this.mainContainer, this.app, this.graphicLibrary);\r\n                    this.presentObjects[objectName] = currentHandle;\r\n                }\r\n\r\n                currentHandle.Repaint(objectInfo, this, this.graphicLibrary);\r\n            }\r\n        }\r\n\r\n        DisplayGameObjects(gameState: GameDesign.ClientGameState): void {\r\n\r\n\r\n            if (!this.isReady || !this.graphicLibrary.isReady)\r\n                return;\r\n\r\n            const startOfCoordinates = gameState.objects[gameState.gameObjectsId].position;\r\n\r\n\r\n            const mainContainerPos = this.ConvertVectorFromGlobalSpaceToViewSpace(startOfCoordinates);\r\n            mainContainerPos.x = -mainContainerPos.x + this.app.screen.width * 0.5 / this.currentStageScale;\r\n            mainContainerPos.y = mainContainerPos.y + this.app.screen.height * 0.5 / this.currentStageScale;\r\n\r\n            this.mainContainer.position.set(mainContainerPos.x, mainContainerPos.y);\r\n\r\n            for (const objectName in gameState.objects) {\r\n                const objectInfo = gameState.objects[objectName];\r\n                this.DisplayGameObject(objectName, objectInfo, startOfCoordinates);\r\n            }\r\n\r\n            this.RemoveUnusedGraphics(gameState);\r\n\r\n        }\r\n\r\n        RemoveAllGraphics(): void {\r\n            for (const existingObjectName in this.presentObjects) {\r\n                this.EnsureGraphicObjectRemoved(existingObjectName);\r\n            }\r\n        }\r\n\r\n        private RemoveUnusedGraphics(gameState: GameDesign.ClientGameState): void {\r\n            for (const existingObjectName in this.presentObjects) {\r\n                if (!(existingObjectName in gameState.objects)) {\r\n                    this.EnsureGraphicObjectRemoved(existingObjectName);\r\n                }\r\n            }\r\n        }\r\n\r\n        private EnsureGraphicObjectRemoved(objectName: string): void {\r\n            if (this.presentObjects[objectName]) {\r\n                const spriteToRemove = this.presentObjects[objectName];\r\n\r\n                spriteToRemove.Destroy();\r\n\r\n                delete this.presentObjects[objectName];\r\n            }\r\n        }\r\n\r\n\r\n    }\r\n\r\n\r\n}\r\n","import * as GameDesign from './gamedesign';\r\n\r\nexport namespace InputUtils {\r\n    /**Handles user input, i.e. allows to retrieve keys that a currently pressed*/\r\n    export class KeyboardInputHandler {\r\n        keyStates: { [key: string]: boolean } = {};\r\n        leftMouseButtonPressed: boolean = false;\r\n        lastAngle: number = 0;\r\n        lastMovementPower: number = 0;\r\n\r\n        constructor(document: Document) {\r\n            document.addEventListener('keydown', (event) => {\r\n                if (event.target == null || !(event.target as Element).matches('input, button')) {\r\n                    this.keyStates[event.code.toUpperCase()] = true;\r\n                }\r\n            });\r\n\r\n            document.addEventListener('keyup', (event) => {\r\n                if (event.target == null || !(event.target as Element).matches('input, button')) {\r\n                    this.keyStates[event.code.toUpperCase()] = false;\r\n                }\r\n            });\r\n\r\n\r\n            document.addEventListener('mousemove', (event) => {\r\n                let mouseX = event.clientX - window.innerWidth * 0.5;\r\n                let mouseY = event.clientY - window.innerHeight * 0.5;\r\n\r\n\r\n                const mouseVector = new GameDesign.ClientVector2();\r\n                mouseVector.x = mouseX;\r\n                mouseVector.y = mouseY;\r\n                this.lastMovementPower = Math.max(Math.min((mouseVector.Length() - 100) / 200, 1), 0);\r\n\r\n                if (mouseY == 0 && mouseX == 0)\r\n                    mouseY = 1;\r\n\r\n\r\n\r\n                this.lastAngle = Math.atan2(-mouseY, mouseX);\r\n            });\r\n\r\n\r\n            document.addEventListener('mousedown', (event) => {\r\n                if (event.target == null || !(event.target as Element).matches('input, button')) {\r\n                    if (event.button === 0) {\r\n                        this.leftMouseButtonPressed = true;\r\n                    }\r\n                }\r\n            });\r\n\r\n            document.addEventListener('mouseup', (event) => {\r\n                if (event.target == null || !(event.target as Element).matches('input, button')) {\r\n                    if (event.button === 0) {\r\n                        this.leftMouseButtonPressed = false;\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        private IsKeyDown(key: string): boolean {\r\n            return this.keyStates[key.toUpperCase()];\r\n        }\r\n\r\n\r\n        /** Retrieves user input from current keyboard + mouse state */\r\n        GetUsersInput(): GameDesign.ClientInput {\r\n            const result = new GameDesign.ClientInput();\r\n\r\n            result.angle = this.lastAngle;\r\n            result.movementPower = this.lastMovementPower;\r\n            result.isFire = this.leftMouseButtonPressed;\r\n\r\n            return result;\r\n        }\r\n    }\r\n\r\n\r\n\r\n}\r\n\r\n","import * as signalR from '@microsoft/signalr';\r\nimport * as MP from '@microsoft/signalr-protocol-msgpack';\r\nimport { Mapper } from './conversion';\r\nimport * as GameDesign from './gamedesign';\r\n\r\nexport namespace Network {\r\n    /** Manages the server connection via SignalR */\r\n    export class ServerConnection {\r\n\r\n        mapper: Mapper;\r\n        connection: signalR.HubConnection;\r\n\r\n        constructor(endpoint: string) {\r\n            this.connection = new signalR.HubConnectionBuilder()\r\n                .withUrl(endpoint)\r\n                .withHubProtocol(new MP.MessagePackHubProtocol())\r\n                .build();\r\n            this.mapper = new Mapper();\r\n        }\r\n\r\n        async SendChatMessage(message: string): Promise<boolean> {\r\n            return await this.connection.invoke<boolean>(\"AddChatMessage\", message);\r\n        }\r\n\r\n        async GetChatMessages(id: number): Promise<GameDesign.GameMessageContainer[] | null> {\r\n            return await this.connection.invoke<GameDesign.GameMessageContainer[] | null>(\"GetChatMessages\", id);\r\n        }\r\n\r\n\r\n        /** Initializes the connection */\r\n        async InitializeServerConnection(personalInfoHandler: (message: GameDesign.ClientGameState) => void): Promise<void> {\r\n            this.connection.on(\"ReceiveGameState\", (message) => {\r\n                if (this.mapper.isReady) {\r\n                    const result = this.mapper.mapClientPersonalInfoFromServer(message) as GameDesign.ClientGameState;\r\n                    personalInfoHandler(result);\r\n                }\r\n            });\r\n            this.connection.on(\"ReceiveRemovalFromGameNotification\", () => {\r\n                document.location = \"/Game/Kicked\";\r\n            });\r\n            await this.connection.start();\r\n            await this.connection.invoke<void>(\"SubscribeToUpdates\");\r\n        }\r\n\r\n        /** Send an input to the server */\r\n        async SendMyInput(input: GameDesign.ClientInput): Promise<void> {\r\n            if (this.mapper.isReady) {\r\n                const result = this.mapper.mapClientInputToServer(input);\r\n                await this.connection.invoke<void>(\"SendInput\", result);\r\n            }\r\n        }\r\n    }\r\n}\r\n","\r\nexport namespace Technical {\r\n\r\n    /** Stores technical information about current game */\r\n    export class TechnicalInfo {\r\n\r\n        /** Number of frames that were correctly retrieved from the server before being rendered */\r\n        goodFrames: number = 0;\r\n\r\n        /** Number of frames that were correctly retrieved from the server before being rendered, but were unnecessary */\r\n        extraGoodFrames: number = 0;\r\n\r\n        /** Number of frames that were extrapolated */\r\n        droppedFrames: number = 0;\r\n\r\n        lastUpdateTime: number = new Date().getTime();\r\n\r\n        lastFrameTimeMs: number = 0;\r\n    }\r\n\r\n}\r\n","import * as GameDesign from './gamedesign';\r\nimport { Technical } from './technical';\r\n\r\nexport namespace UI {\r\n\r\n    //** Handles the UI part of the game's chat and caches messages locally */\r\n    export class ChatController {\r\n        private sendButton: HTMLButtonElement;\r\n        private textContainer: HTMLElement;\r\n        private messageContainer: HTMLInputElement;\r\n\r\n        private lastReceivedMaxMessageId: number = -1;\r\n        private sendMessageNetworkHandler: (message: string) => Promise<boolean>;\r\n        private storedMessages: GameDesign.GameMessageContainer[] = [];\r\n\r\n\r\n        private async SendMessage(): Promise<void> {\r\n            if (this.sendMessageNetworkHandler == null)\r\n                return;\r\n\r\n            const message = this.messageContainer.value;\r\n            if (message == null || message.length > 100 || message.length == 0) {\r\n                return;\r\n            }\r\n\r\n            const result = await this.sendMessageNetworkHandler(message);\r\n\r\n            if (result) {\r\n                this.messageContainer.value = \"\";\r\n            }\r\n        }\r\n\r\n        GetLastReceivedMaxId(): number {\r\n            return this.lastReceivedMaxMessageId;\r\n        }\r\n\r\n\r\n        StoreNewMessages(messages: GameDesign.GameMessageContainer[] | null): void {\r\n\r\n            if (messages == null || messages.length == 0)\r\n                return;\r\n\r\n            const newMax = Math.max(...messages.map(mess => mess.id));\r\n\r\n            if (newMax <= this.lastReceivedMaxMessageId) {\r\n                return;\r\n            }\r\n\r\n\r\n\r\n            for (const message of messages) {\r\n                if (message.id > this.lastReceivedMaxMessageId)\r\n                    this.storedMessages.push(message);\r\n            }\r\n\r\n            if (this.storedMessages.length > 10) {\r\n                this.storedMessages = this.storedMessages.slice(this.storedMessages.length - 10);\r\n            }\r\n\r\n            this.lastReceivedMaxMessageId = newMax;\r\n\r\n\r\n            this.Repaint();\r\n        }\r\n\r\n        Repaint(): void {\r\n            this.textContainer.innerHTML = \"\";\r\n            for (const message of this.storedMessages.slice().reverse()) {\r\n                this.textContainer.innerHTML += '<br>';\r\n                this.textContainer.innerHTML += `${message.message?.senderNick}:${message.message?.message}`;\r\n            }\r\n        }\r\n\r\n        constructor(sendButton: HTMLButtonElement, textContainer: HTMLElement, messageContainer: HTMLInputElement, sendMessageNetworkHandler: (message: string) => Promise<boolean>) {\r\n            this.sendButton = sendButton;\r\n            this.textContainer = textContainer;\r\n            this.messageContainer = messageContainer;\r\n            this.sendMessageNetworkHandler = sendMessageNetworkHandler;\r\n\r\n            this.sendButton.onclick = () => { this.SendMessage(); };\r\n        }\r\n\r\n\r\n    }\r\n\r\n\r\n    /** Stores references to UI elements and handles interaction with them*/\r\n    export class GameUI {\r\n        /** Button used to revive player */\r\n        private reviveButton: HTMLButtonElement;\r\n        /** Window that is displayed when player is dead or not entered the game */\r\n        private reviveMessage: HTMLDivElement;\r\n        /** Text that shows debug info */\r\n        private debugMessage: HTMLParagraphElement;\r\n        /** Table for displaying players info */\r\n        private playersTable: HTMLTableElement;\r\n        /** Message stating that player is in safe zone */\r\n        private safeZoneMessage: HTMLDivElement;\r\n        /** Table for displaying players info */\r\n        private investmentsTable: HTMLTableElement;\r\n        /** An element for damage effects */\r\n        private damageEffects: HTMLElement;\r\n\r\n        private lastInvestmentRequest: number | null = null;\r\n        private lastRepairRequest: boolean = false;\r\n        private lastReviveRequest: boolean = false;\r\n\r\n        AddInputFromUI(input: GameDesign.ClientInput): void {\r\n            input.investmentRequest = this.lastInvestmentRequest;\r\n            input.repairRequest = this.lastRepairRequest;\r\n            input.reviveRequest = this.lastReviveRequest;\r\n            this.lastInvestmentRequest = null;\r\n            this.lastRepairRequest = false;\r\n            this.lastReviveRequest = false;\r\n        }\r\n\r\n        constructor(reviveButton: HTMLButtonElement, reviveMessage: HTMLDivElement, debugMessage: HTMLParagraphElement, playersTable: HTMLTableElement, safeZoneMessage: HTMLDivElement, investmentsTable: HTMLTableElement, damageEffects: HTMLElement) {\r\n            this.debugMessage = debugMessage;\r\n            this.reviveButton = reviveButton;\r\n            this.reviveMessage = reviveMessage;\r\n            this.playersTable = playersTable;\r\n            this.safeZoneMessage = safeZoneMessage;\r\n            this.investmentsTable = investmentsTable;\r\n            this.damageEffects = damageEffects;\r\n        }\r\n\r\n\r\n        RepaintDamageEffects(gameState: GameDesign.ClientGameState | null): void {\r\n            if (gameState == null || !GameDesign.IsPlayerInGame(gameState))\r\n                this.damageEffects.hidden = true;\r\n            else {\r\n                const healthNormalized = gameState.health / gameState.maxHealth;\r\n                this.damageEffects.hidden = false;\r\n                this.damageEffects.style.opacity = (0.3 * (1 - healthNormalized)).toString();\r\n            }\r\n        }\r\n\r\n        RepaintSafeZoneMessage(gameState: GameDesign.ClientGameState | null): void {\r\n            if (gameState == null) {\r\n                this.safeZoneMessage.hidden = true;\r\n            }\r\n            else {\r\n                this.safeZoneMessage.hidden = !gameState.isSafeZone;\r\n            }\r\n        }\r\n\r\n\r\n        RepaintInvestmentsTable(gameState: GameDesign.ClientGameState | null): void {\r\n            if (gameState == null || gameState.alreadyInvested == null || !gameState.isSafeZone) {\r\n                this.investmentsTable.hidden = true;\r\n            }\r\n            else {\r\n\r\n                this.investmentsTable.hidden = false;\r\n\r\n                const repairButton = this.investmentsTable.querySelector(\"#repairButton\") as HTMLDivElement;\r\n\r\n\r\n                if (gameState.health < gameState.maxHealth && gameState.points >= (gameState.maxHealth - gameState.health)) {\r\n                    repairButton.hidden = false;\r\n                    repairButton.onclick = () => { this.lastRepairRequest = true; };\r\n                    repairButton.innerHTML = `Repair for ${(gameState.maxHealth - gameState.health)} points`;\r\n                }\r\n                else {\r\n                    repairButton.hidden = true;\r\n                }\r\n\r\n\r\n                const innerContent = this.investmentsTable.querySelector('tbody') as HTMLTableSectionElement;\r\n\r\n\r\n                for (let i = 0; i <= 6; i++) {\r\n\r\n                    const row = innerContent.rows[i] == undefined ? innerContent.insertRow() : innerContent.rows[i];\r\n\r\n                    const currentVal = gameState.alreadyInvested[i];\r\n\r\n                    const cell1 = row.cells[0] == undefined ? row.insertCell(0) : row.cells[0];\r\n                    cell1.innerHTML = GameDesign.playerAttributes[i];\r\n\r\n                    const cell2 = row.cells[1] == undefined ? row.insertCell(1) : row.cells[1];\r\n                    cell2.innerHTML = `${currentVal}/100`;\r\n\r\n                    const cell3 = row.cells[2] == undefined ? row.insertCell(2) : row.cells[2];\r\n\r\n                    if (cell3.children[0] == undefined) {\r\n                        const newButton = document.createElement(\"div\");\r\n                        newButton.innerHTML = \"Update (10 points)\";\r\n                        newButton.classList.add('btn', 'btn-info', 'btn-sm');\r\n                        cell3.appendChild(newButton);\r\n                    }\r\n                    const updateButton = cell3.children[0] as HTMLDivElement;\r\n\r\n\r\n\r\n\r\n                    if (currentVal < 100 && gameState.points >= 10) {\r\n                        updateButton.hidden = false;\r\n                        row.classList.add('table-success');\r\n                        updateButton.onclick = () => { this.lastInvestmentRequest = i; };\r\n                    }\r\n                    else {\r\n                        updateButton.hidden = true;\r\n                        row.classList.remove('table-success');\r\n                    }\r\n                }\r\n\r\n            }\r\n        }\r\n\r\n\r\n        DebugMyPositionAndVelocity(gameState: GameDesign.ClientGameState, info: Technical.TechnicalInfo): void {\r\n\r\n            const myObj = gameState.objects[gameState.gameObjectsId];\r\n\r\n            this.debugMessage.innerHTML = `Position: ${(myObj.position.x).toFixed(2)},${(myObj.position.y).toFixed(2)};<br>Velocity: ${(myObj.velocity.x).toFixed(2)},${(myObj.velocity.y).toFixed(2)}<br>Drops: ${info.droppedFrames}<br>Goods: ${info.goodFrames}<br>Extra goods: ${info.extraGoodFrames}`;\r\n\r\n            this.debugMessage.innerHTML += `<br> Last frame time: ${info.lastFrameTimeMs} ms`;\r\n\r\n            this.debugMessage.innerHTML += `<br>Players on server: ${gameState.playersCount}`;\r\n\r\n            if (info.goodFrames != 0) {\r\n                this.debugMessage.innerHTML += `<br>DropsToGoods: ${Math.round((info.droppedFrames / info.goodFrames) * 100)}%`;\r\n                this.debugMessage.innerHTML += `<br>ExtraGoodsToGoods: ${Math.round((info.extraGoodFrames / info.goodFrames) * 100)}%`;\r\n            }\r\n            if ('connection' in navigator) {\r\n                const connection = (navigator as any).connection;\r\n                this.debugMessage.innerHTML += `<br>Network: ${connection.effectiveType}`;\r\n                this.debugMessage.innerHTML += `<br>RRT: ${connection.rtt} ms`;\r\n            }\r\n\r\n\r\n\r\n        }\r\n        RepaintReviveInterface(gameState: GameDesign.ClientGameState | null): void {\r\n\r\n            if (gameState != null && gameState.state != GameDesign.PlayerState.Alive) {\r\n                this.reviveMessage.hidden = false;\r\n                this.reviveButton.onclick = () => { this.lastReviveRequest = true; };\r\n            }\r\n            else {\r\n                this.reviveMessage.hidden = true;\r\n            }\r\n        }\r\n    }\r\n\r\n}\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = (module) => {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t757: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunksample\"] = self[\"webpackChunksample\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [712], () => (__webpack_require__(8780)))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["root","factory","exports","module","define","amd","self","deferred","Audio","MusicController","constructor","targetVol","localStorage","getItem","currentVol","parseFloat","this","isNaN","musicInstance","Sound","from","loop","volume","play","AudioController","lastEffectPlayedId","sound","add","PlayOneShot","effect","currentPlayerPosition","position","options","audioClipName","distanceSuqared","GameDesign","DistanceSquared","k","radius","filter","filters","StereoFilter","pan","Normalized","Difference","x","ProcessQueue","queue","currentEffect","id","Initialize","result1","get","clientInputToServerMapping","data","result2","clientPersonalInfoFromServerMapping","isReady","mapClientInputToServer","obj","mapObj","mapClientPersonalInfoFromServer","mapping","result","key","newKey","undefined","Game","GameInstance","playerId","document","technicalInfo","Technical","TechnicalInfo","lastReceivedGameState","lastProcessedGameState","gameUI","UI","GameUI","getElementById","serverConnection","Network","ServerConnection","keyboardInputHandler","InputUtils","KeyboardInputHandler","scene","Graphic","GameScene","MainLoop","audioController","musicController","InitializeServerConnection","message","ReceiveGameState","error","console","chatController","ChatController","async","SendChatMessage","setInterval","GetChatMessages","GetLastReceivedMaxId","then","messages","StoreNewMessages","update","currentUpdateTime","Date","getTime","lastFrameTimeMs","lastUpdateTime","extraGoodFrames","isGood","droppedFrames","ApplyExtrapolation","app","ticker","elapsedMS","goodFrames","view","hidden","RemoveAllGraphics","RepaintReviveInterface","RepaintDamageEffects","RepaintSafeZoneMessage","RepaintInvestmentsTable","input","GetUsersInput","AddInputFromUI","SendMyInput","IsPlayerInGame","DisplayGameObjects","soundEffectsQueue","objects","gameObjectsId","DebugMyPositionAndVelocity","senderNick","playerViewportMaxSize","y","Length","Math","sqrt","LengthSquared","playerAttributes","possiblePlayersStatus","graphicTypeNone","graphicTypeStatic","graphicTypeAnimated","graphicInfo","ClientVector2","targetSize","type","spriteInfo","animatedSpriteInfo","secondsCompleted","GraphicInfo","objectAnimationInfo","graphicLibraryEntryId","a","b","dx","dy","sprite","animationName","isLoop","targetTimeInSeconds","completedTimeInSeconds","currentInfo","newInfo","velocity","angle","children","features","playersCount","isSafeZone","points","alreadyInvested","health","maxHealth","state","PlayerState","NotEntered","gameState","Alive","length","movementPower","isFire","investmentRequest","repairRequest","reviveRequest","delta","objectName","objectInfo","GamePage","universalTextStyle","PIXI","TextStyle","fontFamily","fontSize","fill","align","GraphicLibrary","Init","entries","BackGroundController","background","backgroundTexture","Texture","backgroundObj","TilingSprite","screen","width","height","stage","addChild","HandleWindowResize","window","innerWidth","innerHeight","Destroy","parent","removeChild","SceneObject","child","pixiObj","textForObject","healthBar","parentNode","ApplyTransformations","rotation","set","SetHealthBar","value","progressBarSample","gameScene","graphicLibrary","graphicLibEntry","clonedDiv","cloneNode","objName","appendChild","positionOfObject","mainContainer","currentStageScale","style","display","visibility","left","top","querySelector","setAttribute","toString","SetText","text","Text","anchor","Repaint","gameObject","EnsureCorrectPixiObj","ConvertVectorFromGlobalSpaceToViewSpace","parseInt","RepaintChildren","RemoveUnusedChildren","newChild","newGraphicInfo","NeedToChangeGraphic","CreateFromContainer","CreateFromStaticSprite","CreateFromAnimatedSprite","container","Container","pivot","newSprite","Sprite","AnimatedSprite","fromFrames","Assets","cache","animations","animationSpeed","totalFrames","maxFPS","gotoAndPlay","currentFrame","floor","CheckIfObjectInViewport","stageCoordinates","spriteStageSize","topRight","bottomLeft","ConvertPointFromGlobalSpaceToViewSpace","startOfCoordinates","PrepareSpriteSheet","load","renderer","resize","max","scale","backgroundController","mainLoop","targetFrameRate","presentObjects","Application","backgroundColor","autoDensity","resolution","devicePixelRatio","body","start","addEventListener","DisplayGameObject","positionInViewSpace","GetEstimatedSize","currentHandle","EnsureGraphicObjectRemoved","mainContainerPos","RemoveUnusedGraphics","existingObjectName","keyStates","leftMouseButtonPressed","lastAngle","lastMovementPower","event","target","matches","code","toUpperCase","mouseX","clientX","mouseY","clientY","mouseVector","min","atan2","button","IsKeyDown","ClientInput","endpoint","connection","signalR","HubConnectionBuilder","withUrl","withHubProtocol","MP","MessagePackHubProtocol","build","mapper","Mapper","invoke","personalInfoHandler","on","location","SendMessage","sendMessageNetworkHandler","messageContainer","lastReceivedMaxMessageId","newMax","map","mess","storedMessages","push","slice","textContainer","innerHTML","reverse","sendButton","onclick","lastInvestmentRequest","lastRepairRequest","lastReviveRequest","reviveButton","reviveMessage","debugMessage","playersTable","safeZoneMessage","investmentsTable","damageEffects","healthNormalized","opacity","repairButton","innerContent","i","row","rows","insertRow","currentVal","cells","insertCell","cell3","newButton","createElement","classList","updateButton","remove","info","myObj","toFixed","round","navigator","effectiveType","rtt","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","loaded","__webpack_modules__","call","m","O","chunkIds","fn","priority","notFulfilled","Infinity","fulfilled","j","Object","keys","every","splice","r","d","definition","o","defineProperty","enumerable","g","globalThis","Function","e","prop","prototype","hasOwnProperty","Symbol","toStringTag","nmd","paths","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","some","chunkLoadingGlobal","forEach","bind","__webpack_exports__"],"sourceRoot":""}